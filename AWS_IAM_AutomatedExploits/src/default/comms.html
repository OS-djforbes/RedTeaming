<!DOCTYPE html>
<html lang="en-US" xmlns="http://www.w3.org/1999/html">
    <head>
        <title>communication portal</title>
        <script
			  src="https://code.jquery.com/jquery-3.5.1.min.js"
			  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
			  crossorigin="anonymous"></script>
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">        
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV" crossorigin="anonymous"></script>
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
        
            gtag('config', 'G-QKLJ4S05Q1');
        </script> 
        <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.0.0/crypto-js.min.js" integrity="sha512-nOQuvD9nKirvxDdvQ9OMqe2dgapbPB7vYAMrzJihw5m+aNcf0dX53m6YxM4LgA9u8e9eg9QX+/+mPu8kCNpV2A==" crossorigin="anonymous"></script>
        <script>
            const encryption_key = "1234567890ABCDEF";
            //var iv             = CryptoJS.enc.Hex.parse('101112131415161718191a1b1c1d1e1f');

            String.prototype.hexEncode = function(){
                var hex, i;

                var result = "";
                for (i=0; i<this.length; i++) {
                    hex = this.charCodeAt(i).toString(16);
                    result += ("000"+hex).slice(-4);
                }

                return result
            }

            String.prototype.hexDecode = function(){
                var j;
                var hexes = this.match(/.{1,4}/g) || [];
                var back = "";
                for(j = 0; j<hexes.length; j++) {
                    back += String.fromCharCode(parseInt(hexes[j], 16));
                }

                return back;
            }            

            // Convert hex string to ASCII.
            // See https://stackoverflow.com/questions/11889329/word-array-to-string
            function hex2a(hex) {
                var str = '';
                for (var i = 0; i < hex.length; i += 2)
                    str += String.fromCharCode(parseInt(hex.substr(i, 2), 16));
                return str;
            }


            // A bunch of listeners for onChange events to make things a little easier
            $( function() {
                $('#encryptInputFormatB').click(() => {
                    $('#decryptInputFormatB').prop('checked', true);
                });

                $('#encryptInputFormatH').click(() => {
                    $('#decryptInputFormatH').prop('checked', true);
                });

                $('#decryptInputFormatB').click(() => {
                    $('#encryptInputFormatB').prop('checked', true);
                });

                $('#decryptInputFormatH').click(() => {
                    $('#encryptInputFormatH').prop('checked', true);
                });

                $('#mode').change(function() {
                    $('#dmode').val($('#mode').val());
                });

                $('#encryptivinput').on('input', function() {
                    $('#decryptivinput').val($('#encryptivinput').val());
                });
                
                $('#secretkey').on('input', function() {
                    $('#dsecretkey').val($('#secretkey').val());
                });
            });

            function aes_encrypt(  ) {
                const source_data = $("#inputString").val();
                const encryption_key = $("#secretkey").val();

                ciphertext = CryptoJS.AES.encrypt(source_data, encryption_key );
                
                if ( $('#decryptInputFormatH').is(':checked') ) {
                    // hex encoding checked
                    $("#outputString").val($("#inputString").val().hexEncode());
                    $("#dinputString").val($("#inputString").val().hexEncode());                    
                }else {
                    $('#outputString').val( ciphertext.toString() );
                    $('#dinputString').val( ciphertext.toString() );
                }
            }

            function aes_decrypt(  ) {
                const encrypted_data = $("#dinputString").val()

                const decryption_key = $("#dsecretkey").val();

                var cleartext = CryptoJS.AES.decrypt(encrypted_data, decryption_key ).toString(CryptoJS.enc.Utf8);

                $('#doutputString').val( cleartext );
            }

            function base64Decrypt() {
                const base64 = $('#dinputString').val();
                const words = CryptoJS.enc.Base64.parse(base64);
                
                const textString = CryptoJS.enc.Utf8.stringify(words);
                
                $('#base64decoded').val(textString);

            }
        </script>
    </head>
    <body class="bg-light">
        <div class="wrapper">
            <main id="content">
                <section class="section">
                    <div class="container">
                        <div class="row gap-y">
                            <div class="col-md-12 col-sm-12 col-12">
                                <div class="row">
                                    <div class="col-md-6 col-sm-6 col-xs-12">
                                            <h2>Encryption</h2>
                                            <div class="form-group">
                                                <textarea id="inputString" class="form-control input-lg" rows="6"
                                                          placeholder="Enter plain text to hash"
                                                          name="textToEncrypt"></textarea>
                                                OR<br/>
                                                <input class="form-control input-lg" id="fileInput" type="file"
                                                       file-model="file" name="fileInput" disabled=true/>
                                            </div>
                                            <div class="form-group">
                                                <label for="keysize">Key Size in Bits</label>
                                                <select class="form-control input-lg"id="keysize">
                                                    <option value="128" selected>128</option>
                                                </select>
                                            </div>
                                            <div class="form-group">
                                                <label for="secretkey">Enter Secret Key</label>
                                                <input class="form-control input-lg" id="secretkey"
                                                       placeholder="Enter secret key" name="secretkey"/>
                                            </div>
                                            <div class="form-group form-check form-check-inline">
                                                Input Text Format:
                                                <input class="form-check-input" type="radio" name="encryptInputFormat" id="encryptInputFormatB" value="Base64">
                                                <label class="form-check-label" for="encryptInputFormatB">Base64</label>
                                              </div>
                                              <div class="form-check form-check-inline">
                                                <input class="form-check-input" type="radio" name="encryptInputFormat" id="encryptInputFormatH" value="Hex" disabled=true>
                                                <label class="form-check-label" for="encryptInputFormatH">Hex</label>
                                            </div>
                                            <div class="form-group">
                                                <button class="btn btn-primary" name="hash" value="hash" id='encrypt' onClick="aes_encrypt()">Encrypt
                                                </button>
                                            </div>
        
                                            <div class="form-group">
                                                <label for="outputString">AES Encrypted Output:</label>
                                                <textarea id="outputString" class="form-control input-lg" rows="6"
                                                          placeholder="Result goes here"></textarea>
                                            </div>
                                    </div>
                                    <div class="col-md-6 col-sm-6 col-xs-12 vertical-line">
                                            <h2>Decryption</h2>
                                            <div class="form-group">
                                                <textarea id="dinputString" class="form-control input-lg" rows="6"
                                                          placeholder="Enter text to Decrypt"
                                                          name="textToDecrypt"></textarea>
                                            </div>
                                            <div class="form-group form-check form-check-inline  mb-3">
                                                <br>
                                                Input Text Format:
                                                <input class="form-check-input" type="radio" name="decryptInputFormat" id="decryptInputFormatB" value="Base64">
                                                <label class="form-check-label" for="decryptInputFormatB">Base64</label>
                                              </div>
                                              <div class="form-check form-check-inline">
                                                <input class="form-check-input" type="radio" name="decryptInputFormat" id="decryptInputFormatH" disabled="True" value="Hex">
                                                <label class="form-check-label" for="decryptInputFormatH" >Hex</label>
                                            </div>
                                            <div class="form-group">
                                                <label for="dkeysize">Key Size in Bits</label>
                                                <select class="form-control input-lg" id="dkeysize">
                                                    <option value="128" selected>128</option>
                                                </select>
                                            </div>
                                            <div class="form-group">
                                                <label for="dsecretkey">Enter Secret Key</label>
                                                <input class="form-control input-lg" id="dsecretkey" 
                                                       placeholder="Enter secret key" name="dsecretkey"/>
                                            </div>
                                            <div class="form-group">
                                                <button class="btn btn-primary" name="hash" value="hash"
                                                        onClick="aes_decrypt()">Decrypt
                                                </button>
                                            </div>
                                            <div class="form-group">
                                                <label for="doutputString">AES Decrypted Output:</label>
                                                <textarea id="doutputString" class="form-control input-lg"
                                                          placeholder="Base64 encoded result goes here"
                                                          rows="6"></textarea>
                                            </div>
                                    </div>
                                </div>        
                            </div>
                        </div>
                    </div>
                </section> 
            </main>    
        </div>
        <!-- Footer -->
        <footer class="page-footer font-small blue">

            <!-- Copyright -->
            <div class="footer-copyright text-center py-3">© 2020 Copyright:
                <a href="http://www.bcrindustries.com/index.html">Did You Hack The Building Yet?</a>
            </div>
            <!-- Copyright -->
        
        </footer>
        <!-- Footer -->        
    </body>
</html>