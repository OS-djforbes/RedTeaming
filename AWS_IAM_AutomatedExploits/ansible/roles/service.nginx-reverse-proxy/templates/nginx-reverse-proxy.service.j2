[Unit]
Description=NGINX HTTPS service.
After=docker.socket

[Service]
Type=simple
Restart=on-failure
ExecStartPre=-/usr/bin/docker rm nginx-reverse-proxy
ExecStart=/usr/bin/docker run --name nginx-reverse-proxy \
    --hostname nginx-reverse-proxy \
    --net host \
{% if nginx_volume_mount is defined %}
    -v {{ nginx_volume_mount }} \
{% endif %}
    -v {{ volume_mount }}/certbot/:/etc/letsencrypt \
    -v {{ volume_mount }}/nginx-reverse-proxy/config:/etc/nginx/conf.d \
    {{ nginx_docker_image }}
ExecReload=-/usr/bin/docker exec nginx-reverse-proxy nginx -s reload
ExecStop=-/usr/bin/docker stop nginx-reverse-proxy

[Install]
WantedBy=multi-user.target
