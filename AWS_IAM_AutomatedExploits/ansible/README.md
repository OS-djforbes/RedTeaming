# Gremlins in the Cloud Ansible
This folder contains ansible playbooks for the setup of the target 
infrastructure for the DreamPort RPE 'The Gremlins in the Cloud'. We reuse the
BCR Industries persona created for HackTheBuilding 2020 in this RPE as you can 
see in the website that is deployed. Each playbook is meant to setup a separate
host within a virtual private compute cloud or cloud network (if using Azure or
another cloud provider) and these playbooks should work effectively on VMWare.

We do assume you setup the entire set of playbooks to have a robust network 
instead of only a small number of hosts.

NOTE: These playbooks deliberately have misconfigurations programmed within to
be used in exploitation during an evaluation event. Don't use in production.

## Target Environment
All testing of these playbooks has utilized the following server environments:

* Ubuntu Server 20.04.3 LTS

## Syntax
The following syntax can be used to execute these playbooks. Notice the supply
of a username. This should be changed to match the environment where you run
for testing or production purposes. 

        ansible-playbook setup_alfresco.yml -i 192.168.114.22, -f 10 --ask-become-pass --extra-vars '{"user":"sysadmin"}'


        OR - if you are running a playbook that is interacting with localhost: 

        ansible-playbook <playbook-name.yml>

## Exploit setup
Before running playbooks in the exploit_playbooks directory you will want to verify a few things:
1. (Only if you did not do this already) Add the vulnerable profiles to your AWS credentials file, and change the account number.
      * The following commands make a backup of your current AWS credentials file, then takes the example credentials file from the repo and replaces the placeholder account with your target account number, and finally adds all of the IAM Vulnerable privesc profiles to your credentials file so you can use them:
      * `cp ~/.aws/credentials ~/.aws/credentials.backup`
      * `printf "\n" >> ~/.aws/credentials & tail -n +7 aws_credentials_file_example | sed s/account_id/$(aws sts get-caller-identity | grep Account | awk -F\" '{print $4}')/g >> ~/.aws/credentials`
2. You will need to add your account id the vars.yl file located in the group_vars directory like so:
    Example:    account_id: <Place account ID here>   >>> account_id: 1234567890 
